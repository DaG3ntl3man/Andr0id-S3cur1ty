<!DOCTYPE HTML>
<html lang="en" class="dark" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Introduction to Android Security</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('dark')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><div>Android Security</div></li><li class="chapter-item expanded "><a href="home_0.html">Andr0101100100</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_1.html" class="active">Introduction to Android Security</a></li><li class="chapter-item "><a href="chapter_1_1.html">Android Architecture</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction-to-android-security"><a class="header" href="#introduction-to-android-security">Introduction to Android Security</a></h1>
<blockquote>
<p><strong>Android is based on the Linux Operating System!</strong></p>
</blockquote>
<p>→ Meaning your anroid can take commands just like any Linux device. Ex: ls, cd, rm, etc,. <br>
→ Permissions to folders and applications are dependent on the Linux
Operating System file permission model (_ xxx xxx xxx)</p>
<pre><code class="language-shell"># ls -l file
  - rw- r-- r--@ 1 root root 0 Nov 19 23:49 file
  |  |   |   |
  |  |   |   |                  |
  |  |   | Other (r--)          |             
  |  |   |                      |         
  |  | Group (r--)              |               r  =  Readable
  |  |                          |               w  =  Writeable
  |  |                          |               x  =  Executable
  | Owenr (rw-)                 |               -  =  Denied
  |                             |             
  |                             |                
  |                             |
 File type 
</code></pre>
<h2 id="dalvik-vs-the-android-runtime"><a class="header" href="#dalvik-vs-the-android-runtime"><span style="color:#92A8D1">Dalvik</span> vs the <span style="color:#88B04B">Android Runtime</span></a></h2>
<div align="center"> <iframe src="https://giphy.com/embed/TYgQAdsygGRfHaiCKY" width="480" height="400" frameBorder="0" class="giphy-embed" allowFullScreen></iframe></div>
<h3 id="dalvik"><a class="header" href="#dalvik"><span style="color:#92A8D1">Dalvik</span></a></h3>
<p>Every application on Android phone or an Android emulator is run in a virtual machine known as the Android Runtime</p>
<ul>
<li>Dalvik was the original runtime VM, and is still referenced to by the name Dalvik bytecode
<ul>
<li>Dalvik is not utilised in <strong>modern Android OS</strong>, and has been replaced by the ART. <em>(In some cases it is still refered to as Dalvik Byte-code.)</em></li>
</ul>
</li>
</ul>
<h3 id="android-runtime"><a class="header" href="#android-runtime"><span style="color:#88B04B">Android Runtime</span></a></h3>
<ul>
<li>This is the modern translation layer from the application's bytecode to device instructions</li>
<li>Every app runs in its own sandboxed virtual machine</li>
<li>Likewise, in the file system applications are isolated by creating a new user unique for that application</li>
</ul>
<h2 id="android-identity-and-access-management"><a class="header" href="#android-identity-and-access-management">Android Identity and Access Management</a></h2>
<p>As mentioned, each application has its own user for the application.</p>
<p>This user is the owner of the application directory (UID between 10000 and 999999, username similar: i.e. u0_a188 for UID 10188)</p>
<ul>
<li>/data/app/com.example1.app - <strong>generic application data</strong></li>
<li>/data/data/com.example.app - <strong>runtime storage of data</strong></li>
<li>/mnt/sdcard/Android/data/com.example2.app - <strong>externally stored location for runtime</strong></li>
<li>/data/data/com.example2.app - <strong>a different app requiring different user</strong></li>
</ul>
<p>Let's take the above use case scenario in an Android OS, here there are two different application <strong>example1</strong> and <strong>example2</strong></p>
<p>Both have entirely separate directories i.e <code>/data/app/com.example1.app</code> and <code>/data/data/com.example2.app</code> -&gt; This is a totally separate directory owned by a different user with a different UID, <em>(both the apps are installed on the same phone).</em></p>
<p>So because every single application is assigned to its own directory with its own user account, that's the owner of its directory, <strong>this stops applications from interacting with each other unless explicitly granted permissions, or a Content Provider/Broadcast Receiver is exposed.</strong>
<br></p>
<h4 id="how-a-developer-usually-will-grant-permissions-to-an-application-to-share-some-data-is-either-through-a-content-provider-or-a-broadcast-receiver"><a class="header" href="#how-a-developer-usually-will-grant-permissions-to-an-application-to-share-some-data-is-either-through-a-content-provider-or-a-broadcast-receiver">How a developer usually will <strong>grant permissions</strong> to an application to share some data is either through a Content Provider or a Broadcast Receiver?</a></h4>
<p>For this question let's an everyday use case from user's perspective, when you click on a link or an url to open, there will be a small pop up window that opens in your mobile asking for which application the url or the content to be opened, mostly an URL</p>
<ol>
<li><strong>Broadcast Receiver</strong></li>
</ol>
<p align="left">
<img width=404 height=202 src="./app_permission.JPG">
</p>
What you are seeing above is when we will be using a broadcast receiver to receive some data, such above applications(Web Browsers in our case) would be exposing a broadcast receiver and waiting for the application data to come across through them.
<ol start="2">
<li><strong>Content Provider</strong><br>
<br>
This is similar to the broadcast receiver but instead of waiting for a response, our application is being served some kind of data out to other applications, if that content provider is exported.</li>
</ol>
<h3 id="root-users-system-level-accounts"><a class="header" href="#root-users-system-level-accounts">Root Users, System Level accounts</a></h3>
<blockquote>
<p>Root users and system level a/c' are the only way that we are gonna be able to get access to all of the directories</p>
</blockquote>
<p><strong><span style="color:#88B04B">Emulators with non-Google Play APIs allow <span style="color:#DD4124">$ root</span></strong></p>
<hr />
<ul>
<li><strong>Profiles</strong> → This can not allow you to separate not only application data but is can also allow you to separate functions such as the clipboard, contacts, camera etc,. into their own separate profiles.</li>
</ul>
<p>A real life use case explanation for this would be when you have a phone with a personal and also a work profile on it and you want to isolate those two things from each other, while the profiles still have access to system level functions such as Wifi, Bluetooth 4G LTE, etc,.</p>
<ul>
<li>
<p>Separated App Data, useful for things like BYOD (<strong>B</strong>ring <strong>Y</strong>our <strong>O</strong>wn <strong>D</strong>evice)</p>
<ul>
<li>Work Profile, Personal Profile, Always-On VPN for certain apps</li>
<li>Still has access to system level functions such as Wifi, Bluetooth, 4G LTE, but can have isolated aspects for Data Loss Prevention like a clipboard (copy-paste), contacts, camera, etc.</li>
</ul>
</li>
<li>
<p><strong>Primary User</strong> - this is the user created first time the phone is started, always running, can only be removed by factory reset</p>
</li>
<li>
<p><strong>Secondary User</strong> - Additional users you can add to the device, and can be created/deleted by the primary user</p>
</li>
<li>
<p><strong>Guest User</strong> - can only be one guest user at a time, a fast way to have guest access to the phone</p>
</li>
<li>
<p><strong>Kid Mode</strong> - Google Kids Spaces (tablets only), Profiles/Account for Kids, usually vendor specific Samsung Kid Mode</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="home_0.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="chapter_1_1.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="home_0.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="chapter_1_1.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="editor.js"></script>
        <script src="mode-rust.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
